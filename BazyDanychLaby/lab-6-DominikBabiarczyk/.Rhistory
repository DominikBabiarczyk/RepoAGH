install.packages("tidyverse")
install.packages("nycflights13")
library(nycflights13)
library(dplyr)
library(dypry)
library(dyplr)
library(dyplr)
library(nycflights13)
install.packages("DBI")
library(DBI)
# Ścieżka do pliku bazy danych nycflights13
db_path <- system.file("extdata", "nycflights13.sqlite", package = "nycflights13")
# Połącz się z bazą danych SQLite
con <- dbConnect(SQLite(), db_path)
# Ścieżka do pliku bazy danych nycflights13
db_path <- system.file("extdata", "nycflights13.sqlite", package = "nycflights13")
# Połącz się z bazą danych SQLite
con <- dbConnect(SQLite(), db_path)
print(nycflights13)
nycflights13::flights
flights <- nycflights13::flights
library(tidyverse)
library(nycflights13)
library(DBI)
library(dplyr)
glimpse(flights)
flights <- nycflights13::flights
glimpse(flights)
flights <- nycflights13::flights
glimpse(flights)
flights |> filter(dep_delay >= 2) |> print()
flights <- nycflights13::flights
glimpse(flights)
flights |> filter(dep_delay >= 2) |> print()
flights |> filter(dep_delay >= 1) |> print()
flights |> filter(dep_delay >= 4) |> print()
flights |> filter(dep_delay >= 2) |> print()
flights |> filter(dest = 'IAH' OR  'HOU') |> print()
flights |> filter(dest = 'IAH' OR  dest = 'HOU') |> print()
flights |> filter(dest = 'IAH') |> print()
flights |> filter(dest == 'IAH') |> print()
flights |> filter(dest == 'IAH','HOU') |> print()
flights |> filter(dest == 'IAH'| dest = 'HOU') |> print()
flights |> filter(dest == 'IAH'| dest == 'HOU') |> print()
flights |> filter(flight = 'UM' | flight = 'AM' | flight = 'DE') print()
flights |> filter(flight == 'UM' | flight == 'AM' | flight == 'DE') print()
flights |> filter(flight == 'UM' | flight == 'AM' | flight == 'DE') |> print()
flights |> filter(flight == 'UN' | flight == 'AM' | flight == 'DL') |> print()
flights |> filter(carrier == 'UN' | carrier == 'AM' | carrier == 'DL') |> print()
flights |> filter(carrier == 'UA' | carrier == 'AM' | carrier == 'DL') |> print()
flights |> filter(carrier == 'UA' | carrier == 'AA' | carrier == 'DL') |> print()
flights |> filter(month == 'August' | month == 'September' | month == 'July') |> print()
flights |> filter(month == 7 | month == 8 | month == 9) |> print()
flights |> filter(dep_delay >= 120 ) |> print()
flights |> filter(dep_delay >= 120 & ((sched_dep_time - dep_time) < 1)) |> print()
flights |> filter(dep_delay >= 120 ) |> print()
flights |> filter(dep_delay >= 120 & ((sched_dep_time - dep_time) < 1)) |> print()
flights |> filter(dep_delay >= 30 & (sched_arr_time-sched_dep_time)-(arr_time-dep_time) > 30) |> print()
flights |> filter(dep_delay >= 60 & (sched_arr_time-sched_dep_time)-(arr_time-dep_time) > 30) |> print()
flights |> arrange(dep_time) |> print()
flights |> arrange(desc(dep_time)) |> print()
flights |> arrange(desc(dep_delay)) |> print()
flights |> arrange(desc(dep_delay), time_hour) |> print()
flights |> arrange(time_hour) |> print()
flight$hour
flights |> filter(hour < 12) |> arrange(dep_delay) |> print()
flights |> filter(hour < 12) |> arrange(desc(dep_delay)) |> print()
flights |> filter(hour < 10) |> arrange(desc(dep_delay)) |> print()
flights |> arrange(sched_arr_time - sched_dep_time)
flights |> filter(dep_delay >= 60 & (
as.POSIXct(sprintf("%04d", sched_arr_time), format = "%H%M")-
as.POSIXct(sprintf("%04d", sched_dep_time), format = "%H%M"))-
( as.POSIXct(sprintf("%04d", arr_time), format = "%H%M")-
as.POSIXct(sprintf("%04d", dep_time), format = "%H%M")) > 30)
|> print()
flights |> filter(dep_delay >= 60 & (sched_arr_time-sched_dep_time)-(arr_time-dep_time) > 30) |> print()
flights |> filter(dep_delay >= 60 & ((sched_arr_time-sched_dep_time)-(arr_time-dep_time) > 30)) |> print()
flights |> filter(dep_delay >= 60 & ((
as.POSIXct(sprintf("%04d", sched_arr_time), format = "%H%M")-
as.POSIXct(sprintf("%04d", sched_dep_time), format = "%H%M"))-
( as.POSIXct(sprintf("%04d", arr_time), format = "%H%M")-
as.POSIXct(sprintf("%04d", dep_time), format = "%H%M"))) > 30) |> print()
flights |> arrange(as.POSIXct(sprintf("%04d", sched_arr_time), format = "%H%M") - as.POSIXct(sprintf("%04d", sched_dep_time), format = "%H%M")) |> print()
fligts |> arrange(day) |> disctinct(day) |> print()
fligts |> arrange(day) |> distinct(day) |> print()
flights |> arrange(day) |> distinct(day) |> print()
flights |> distinct(month, day) |> print()
flights |> distinct(month, day) |> count() |> print()
number_day <- flights |> distinct(month, day) |> count() |> print()
number_day <- flights |> distinct(month, day) |> count() |> print()
if( number_day >= 365){
print("tak")
}else{
print("nie")
}
number_day <- flights |> filter(year == 2013) |> distinct(month, day) |> count() |> print()
if( number_day >= 365){
print("tak")
}else{
print("nie")
}
flights |> arrange(desc(distance)) |> slice_head(n = 10) |> print()
flights |> arrange(desc(distance)) |> slice_head(n = 10) |> print()
flights |> arrange(asc(distance)) |> slice_head(n = 10) |> print()
flights |> arrange(desc(distance)) |> slice_head(n = 10) |> print()
flights |> arrange(distance) |> slice_head(n = 10) |> print()
flights |> filter(distance ==  80 | distance == 81) |> print()
flights |> filter(distance ==  90 | distance == 91) |> print()
flights |> filter(distance ==  3400 | distance == 91) |> print()
flights |> filter(distance ==  4998 | distance == 91) |> print()
flights |> filter(distance ==  4983 | distance == 17) |> print()
flights |> filter(distance ==  4983 | distance == 17) |> arrange(distance) |> print()
flights |> filter(distance ==  4983 | distance == 17) |> arrange(distance) |> print()
flights |>  arrange(distance) |> filter(distance ==  4983 | distance == 17)  |> print()
