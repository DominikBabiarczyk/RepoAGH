---
title: "bazyDanychLab1"
format: html
editor: visual
---

```{r}
library(DBI)
library(RPostgres)

dsn_database = "wbauer_adb_2023"   
dsn_hostname = "pgsql-196447.vipserv.org"  
dsn_port = "5432"                
dsn_uid = "wbauer_adb"        
dsn_pwd = "adb2020"  

con <- dbConnect(Postgres(), dbname = dsn_database, host=dsn_hostname, port=dsn_port, user=dsn_uid, password=dsn_pwd) 
```

1.Kategorie Filmów:

```{r}
df2<-dbGetQuery(con,"SELECT * FROM INFORMATION_SCHEMA.tables where table_schema='public'")
print(df2)

category <- dbGetQuery(con, 'SELECT * FROM category') 
print(category)
rozmiar <- dim(category)
print(rozmiar[1])

```

2.  Wyświetl listę kategorii w kolejności alfabetycznej.

```{r}
category_alphabet <- dbGetQuery(con, "SELECT name FROM category ORDER BY name ASC") 
print(category_alphabet)
```

3.  Znajdź najstarszy i najmłodszy film do wypożyczenia.

    ```{r}
    release_year <- dbGetQuery(con, "SELECT release_year FROM film")
    the_youngest <- dbGetQuery(con, "SELECT * FROM film ORDER BY release_year DESC LIMIT 1 ")
    print(the_youngest)
    the_oldest <- dbGetQuery(con, "SELECT * FROM film ORDER BY release_year ASC LIMIT 1 ")
    print(the_oldest)
    ```

4.  Ile wypożyczeń odbyło się między 2005-07-01 a 2005-08-01?

```{r}
film <- dbGetQuery(con, "SELECT * FROM rental")
print(film)
rental <- dbGetQuery(con, "SELECT rental_date FROM rental WHERE rental_date >= '2005-07-01' AND rental_date <= '2005-08-01'")
print(rental)
print(dim(rental)[1])
```

5.  Ile wypożyczeń odbyło się między 2010-01-01 a 2011-02-01?

```{r}
rental <- dbGetQuery(con, "SELECT rental_date FROM rental WHERE rental_date >= '2010-01-01' AND rental_date <= '2011-02-01'")
print(dim(rental)[1])
```

6.  Znajdź największą płatność wypożyczenia.

```{r}
payment <- dbGetQuery(con, "SELECT * FROM payment ")
print(payment)
maxPayment <- dbGetQuery(con, "SELECT * FROM payment ORDER BY amount DESC LIMIT 1")
print(maxPayment)
```

7.  Znajdź wszystkich klientów z Polski, Nigerii lub Bangladeszu.

    ```{r}
    customer <- dbGetQuery(con, "SELECT * FROM customer_list")
    name_country <- dbGetQuery(con,"SELECT name FROM customer_list WHERE country = 'Polska' OR country = 'Nigeria' OR country = 'Bangladesz'")
    print(customer)
    print(name_country)
    ```

    8.  Gdzie mieszkają członkowie personelu

```{r}
connection1 = dbGetQuery(con, "SELECT country from staff 
                INNER JOIN address ON staff.address_id = address.address_id
                INNER JOIN city ON address.city_id = city.city_id
                INNER JOIN country ON city.country_id = country.country_id")
print(connection1)

```

9.  Ilu pracowników mieszka w Argentynie lub Hiszpanii?

    ```{r}
    connection1 = dbGetQuery(con, "SELECT country from staff 
                    INNER JOIN address ON staff.address_id = address.address_id
                    INNER JOIN city ON address.city_id = city.city_id
                    INNER JOIN country ON city.country_id = country.country_id
                            WHERE country = 'Argentyna' OR country = 'Hiszpania'")
    print(connection1)
    ```

    10. Jakie kategorie filmów zostały wypożyczone przez klientów?

```{r}
categoryRent <- dbGetQuery(con, "SELECT DISTINCT name FROM category
    INNER JOIN film_category ON category.category_id = film_category.category_id
    INNER JOIN film ON film_category.film_id = film.film_id
    INNER JOIN inventory ON film.film_id = inventory.film_id
    INNER JOIN rental ON inventory.inventory_id = rental.inventory_id")
print(categoryRent)
```

11. Znajdź wszystkie kategorie filmów wypożyczonych w Ameryce.

    ```{r}
    categoryAmeryka <- dbGetQuery(con, "SELECT DISTINCT name FROM category
        INNER JOIN film_category ON category.category_id = film_category.category_id
        INNER JOIN film ON film_category.film_id = film.film_id
        INNER JOIN inventory ON film.film_id = inventory.film_id
        INNER JOIN rental ON inventory.inventory_id = rental.inventory_id
        INNER JOIN staff ON rental.staff_id = staff.staff_id
        INNER JOIN store ON staff.store_id = store.store_id
        INNER JOIN address ON staff.address_id = address.address_id
        INNER JOIN city ON address.city_id = city.city_id
        INNER JOIN country ON city.country_id = country.country_id
        WHERE country = 'Mexico' OR country = 'Canada' OR country = 'United States'")
    print(categoryAmeryka)
    ```

12. Znajdź wszystkie tytuły filmów, w których grał: Olympia Pfeiffer lub Julia Zellweger lub Ellen Presley

    ```{r}
    actors <- dbGetQuery(con, "SELECT DISTINCT title FROM actor
              INNER JOIN film_actor ON actor.actor_id = film_actor.actor_id
              INNER JOIN film ON film_actor.film_id = film.film_id
              WHERE (first_name='Olympia' AND last_name='Pfeiffer') OR (first_name            ='Julia' AND last_name='Zellweger') OR (first_name='Ellen' AND                  last_name='Presley')")
    print(actors)
    ```
